---
import BaseHead from "../components/BaseHead.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../consts";
import { getCollection } from "astro:content";
import FormattedDate from "../components/FormattedDate.astro";
import FormattedTags from "../components/FormattedTags.astro";

const posts = (await getCollection("works")).sort(
    (b, a) => a.data.pubDate.valueOf() - b.data.pubDate.valueOf(),
);
---

<script>
    // Enable hover effect on touch devices through tap gestures
    // When hovered by a computer, the opacity is automatically set to 0.9 and the link is clickable
    const postLinks = document.getElementById("postLinks");
    postLinks.addEventListener("click", (event) => {
        const currOpacity = window.getComputedStyle(event.target).getPropertyValue("opacity");
        if (currOpacity != 0.9) {
            event.preventDefault();
            event.target.style.opacity = "0.9";
        }
    });
</script>

<html lang="en">
    <head>
        <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
    </head>
    <body>
        <Header />
        <div class="h-20"></div>
        <main class="max-w-[54rem] mx-auto">
            <section class="mx-3">
                <h1 class="text-4xl font-bold mb-4">Hi</h1>
                <p>
                    I'm a software engineer and I build products with human-centric design. I write about
                    software engineering, productivity, and personal growth. I'm currently building out my
                    portfolio while looking for full-time employment. If you're interested in working
                    together, feel free to reach out.
                </p>
                <p>~~~Links go here~~~</p>
            </section>
            <section class="mx-3">
                <div class="h-14" id="posts"></div>
                <ul id="postLinks">
                    {
                        posts.map((post) => (
                            <a
                                href={`/works/${post.slug}/`}
                                class="text-content-base hover:text-accent duration-75"
                            >
                                <li class="mt-14">
                                    <div class="relative mx-auto ">
                                        <div class="absolute w-full h-full hover:opacity-90 opacity-0 bg-primary text-content-base flex items-center justify-center duration-100">
                                            <p class="mx-8 my-2 text-center">{post.data.description}</p>
                                        </div>
                                        <img
                                            class="shadow-emphasis object-cover aspect-video "
                                            src={post.data.heroImage}
                                            alt=""
                                        />
                                    </div>
                                    <div class="flex justify-between mx-1 mt-2">
                                        <p class="hover:text-accent font-bold text-2xl text-left mb-0">
                                            {post.data.title}
                                        </p>

                                        <FormattedTags tags={post.data.tags} />
                                    </div>
                                </li>
                            </a>
                        ))
                    }
                </ul>
            </section>
        </main>
        <Footer />
    </body>
</html>
